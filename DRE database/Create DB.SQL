-- Table: masterdata.jobs
CREATE TABLE IF NOT EXISTS masterdata.jobs
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    "jobKey" text COLLATE pg_catalog."default",
    datetime timestamp with time zone NOT NULL,
    "energySource" text COLLATE pg_catalog."default",
    plan text COLLATE pg_catalog."default",
    progress text COLLATE pg_catalog."default",
    parameters text COLLATE pg_catalog."default",
    "downloadUrl" text COLLATE pg_catalog."default",
    "forType" text COLLATE pg_catalog."default",
    "keyHandler" text COLLATE pg_catalog."default",
    "userEmail" text COLLATE pg_catalog."default",
    comments text COLLATE pg_catalog."default",
    file text COLLATE pg_catalog."default",
    isdeleted boolean NOT NULL DEFAULT false,
    isuivisible boolean NOT NULL DEFAULT false,
    requestserver text COLLATE pg_catalog."default",
    answer text COLLATE pg_catalog."default",
    statuscode integer NOT NULL DEFAULT 0,
    totalruns integer NOT NULL DEFAULT 0,
    CONSTRAINT "PK_jobs" PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS masterdata.jobs
    OWNER to tsdbadmin;




-- Table: data.jobfiles
CREATE TABLE IF NOT EXISTS data.jobfiles
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    job_response_id integer NOT NULL,
    file_name text COLLATE pg_catalog."default",
    file_path text COLLATE pg_catalog."default",
    file_size integer NOT NULL,
    CONSTRAINT "PK_jobfiles" PRIMARY KEY (id),
    CONSTRAINT "FK_jobfiles_jobsresponses_job_response_id" FOREIGN KEY (job_response_id)
        REFERENCES data.jobsresponses (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE CASCADE
)

TABLESPACE pg_default;


-- Table: data.jobsresponses
CREATE TABLE IF NOT EXISTS data.jobsresponses
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    job_id integer NOT NULL,
    datetime timestamp with time zone NOT NULL,
    "energySource" text COLLATE pg_catalog."default",
    status text COLLATE pg_catalog."default",
    error text COLLATE pg_catalog."default",
    payload text COLLATE pg_catalog."default",
    responseserver text COLLATE pg_catalog."default",
    payloadfixed text COLLATE pg_catalog."default",
    CONSTRAINT "PK_jobsresponses" PRIMARY KEY (id),
    CONSTRAINT "FK_jobsresponses_jobs_job_id" FOREIGN KEY (job_id)
        REFERENCES masterdata.jobs (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE CASCADE
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS data.jobsresponses
    OWNER to tsdbadmin;

CREATE INDEX IF NOT EXISTS "IX_jobsresponses_job_id"
    ON data.jobsresponses USING btree
    (job_id ASC NULLS LAST)
    TABLESPACE pg_default;





-- Table: data.dailyjoblogs
CREATE TABLE IF NOT EXISTS data.dailyjoblogs
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    datetime timestamp with time zone NOT NULL,
    jobkey text COLLATE pg_catalog."default",
    answer text COLLATE pg_catalog."default",
    success boolean NOT NULL,
    request text COLLATE pg_catalog."default",
    aux text COLLATE pg_catalog."default",
    localerror text COLLATE pg_catalog."default",
    server text COLLATE pg_catalog."default",
    CONSTRAINT "PK_dailyjoblogs" PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS data.dailyjoblogs
    OWNER to tsdbadmin;





-- Table: graphdata.demodata
CREATE TABLE IF NOT EXISTS graphdata.demodata
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    key text COLLATE pg_catalog."default",
    datatype text COLLATE pg_catalog."default",
    classdeserial text COLLATE pg_catalog."default",
    plant_id integer NOT NULL,
    payload text COLLATE pg_catalog."default",
    CONSTRAINT "PK_demodata" PRIMARY KEY (id)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS graphdata.demodata
    OWNER to tsdbadmin;


